# Compare cases and controls

The case-control variable is `type`.

```{r}
results <- rbind(compare("bsa", "Body surface area"),
                 compare("nr_frac", "NR fraction"),
                 compare("rl_frac", "RL fraction"),
                 compare("ln_frac", "LN fraction"),
                 compare("total_area_value", "Total coaptation area, value"),
                 compare("total_area", "Total coaptation area, calculated"),
                 compare("orifice_area", "Orifice area"),
                 compare("valve_diameter", "Valve diameter"),
                 compare("valve_area", "Valve area"),
                 compare("a_coap_size_valve", "Total valve coaptation area relative to valve diameter"),
                 compare("a_coap_orifice_area", "Total valve coaptation area relative to orifice area"),
                 compare("a_coap_valve_area", "Total valve coaptation area relative to valve area"),
                 compare("coapt_line_length", "Coaptation line length"),
                 compare("radial", "Coaptation line length"),
                 compare("polar", "Polar angle of coaptation line (top to bottom"),
                 compare("azimuthal", "Azimuthal angle of coaptation line"),
                 compare("total_area_valueScaled", "Total coaptation area, value, scaled to BSA"),
                 compare("total_areaScaled", "Total coaptation area, calculated, scaled to BSA"),
                 compare("orifice_areaScaled", "Orifice area scaled to BSA"),
                 compare("valve_diameterScaled", "Valve diameter scaled to BSA"),
                 compare("valve_areaScaled", "Valve area scaled to BSA"),
                 compare("radialScaled", "Coaptation line length scaled to BSA"))
```

Plot comparisons.

Images are saved as [PNG](../figures/densityplots-1.png) and [SVG](../figures/densityplots.svg) files.

var <- "^id|^type|radial|polar|azimuthal|Scaled|frac|a_coap|bsa"
```{r densityplots, dpi = 300, fig.height = 6, fig.width = 9}
df1 <-
  df %>%
  select(matches(var)) %>%
  melt(id.vars = c("id", "type")) %>% 
  mutate(type = factor(type))
levels(df1$variable)
g <-
  df1 %>% 
  ggplot +
    aes(x = value, color = type, fill = type) +
    geom_density(alpha = 1/3) +
    scale_x_continuous("") +
    scale_y_continuous("", labels = NULL) +
    scale_color_brewer("", palette = "Set1") +
    scale_fill_brewer("", palette = "Set1") +
    facet_wrap(~ variable, ncol = 4, scales = "free") +
    theme_bw() +
    theme(legend.position = "bottom",
          panel.grid = element_blank())
g
ggsave("../figures/densityplots.svg", dpi = 300, height = 6, width = 9, units = "in")
```

```{r scatterplots, dpi = 300, fig.height = 6, fig.width = 9}
g <-
  df1 %>% 
  ggplot +
    aes(x = value, y = type, color = type, fill = type) +
    geom_jitter(alpha = 1/3) +
    scale_x_continuous("") +
    scale_y_discrete("", labels = NULL) +
    scale_color_brewer("", palette = "Set1") +
    scale_fill_brewer("", palette = "Set1") +
    facet_wrap(~ variable, ncol = 4, scales = "free") +
    theme_bw() +
    theme(legend.position = "bottom",
          panel.grid = element_blank())
g
ggsave("../figures/scatterplots.svg", dpi = 300, height = 6, width = 9, units = "in")
```

Adjust p-values for multiple comparisons.

```{r}
results <-
  results %>%
  mutate(pAdjust = p.adjust(pValue, method = "BH"),
         sig = pAdjust < 0.05)
```

Output results.

```{r}
results %>% kable
results %>% write.csv(file = "../data/processed/compare.csv",
                      row.names = FALSE,
                      na = "")
```
