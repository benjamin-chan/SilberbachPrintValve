# 3D plot

[Interactive HTML](../figures/webGL/sphereplot.html)

Predicted values from MANOVA.
**Returns some weird results;**
Predicted values do not plot in the middle of the *cloud* of data points.

```{r, echo = TRUE, eval = FALSE}
M <-
  df %>% 
  select(centroidBottomRotatedX, centroidBottomRotatedY, centroidBottomZ, type, orifice_area) %>% 
  manova(cbind(centroidBottomRotatedX, centroidBottomRotatedY, centroidBottomZ) ~ 
           type,
         data = .)
summary.aov(M)
summary.manova(M)
pred <- 
  bind_cols(df %>% select(type), 
            M %>% predict %>% data.frame) %>% 
  select(type, centroidBottomRotatedX, centroidBottomRotatedY, centroidBottomZ) %>% 
  unique %>%
  bind_cols(., 
            sphereplot::car2sph(.$centroidBottomRotatedX, 
                                .$centroidBottomRotatedY, 
                                .$centroidBottomZ) %>% data.frame)
pred
```

```{r}
col <- brewer.pal(5, "Set1")
rgl.sphgrid(radius = df$magnitude %>% max,
            col.long = col[1], col.lat = col[2],
            deggap = 30, longtype = "D", radlab = "Distance")
rgl.sphpoints(long = df %>% filter(type == "Case") %>% select(longitude),
              lat = df %>% filter(type == "Case") %>% select(latitude),
              radius = df %>% filter(type == "Case") %>% select(magnitude),
              col = col[1],
              deg = TRUE, size = 5, alpha = 1/2)
rgl.sphpoints(long = df %>% filter(type == "Control") %>% select(longitude),
              lat = df %>% filter(type == "Control") %>% select(latitude),
              radius = df %>% filter(type == "Control") %>% select(magnitude),
              col = col[2],
              deg = TRUE, size = 5, alpha = 1/2)
rgl.sphpoints(long = pred %>% filter(type == "Case") %>% select(long),
              lat = pred %>% filter(type == "Case") %>% select(lat),
              radius = pred %>% filter(type == "Case") %>% select(radius),
              col = col[1],
              deg = TRUE, size = 10, alpha = 1/2)
rgl.sphpoints(long = pred %>% filter(type == "Control") %>% select(long),
              lat = pred %>% filter(type == "Control") %>% select(lat),
              radius = pred %>% filter(type == "Control") %>% select(radius),
              col = col[2],
              deg = TRUE, size = 10, alpha = 1/2)
dir <- file.path("~/Projects/SilberbachPrintValve/figures/webGL")
writeWebGL(dir = dir, filename = file.path(dir, "sphereplot.html"), width = 1080)
```
