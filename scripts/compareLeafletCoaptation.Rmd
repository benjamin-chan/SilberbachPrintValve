# Compare leaflet coaptation fractions

Comparison variables are

* `nr_frac` Fraction of coaptation area between non-coronary and right coronary leaflets of total coaptation area
* `rl_frac` Fraction of coaptation area between right and left coronary leaflets of total coaptation area
* `ln_frac` Fraction of coaptation area between left coronary and non-coronary leaflets of total coaptation areas

[PNG](../figures/lineplotsLeafletsCoapFrac.png), [SVG](../figures/lineplotsLeafletCoapFrac.svg)

![Line plot](../figures/lineplotsLeafletsCoapFrac.png)

```{r lineplotsLeafletsCoapFrac, fig.show = "hide"}
var <- "^id|^type$|_frac$"
df1 <-
  df %>%
  select(matches(var)) %>%
  melt(id.vars = c("id", "type")) %>% 
  mutate(type = factor(type)) %>% 
  rename(frac = value) %>% 
  mutate(variable = factor(variable,
                           levels = c("nr_frac", "rl_frac", "ln_frac"),
                           labels = c("NR", "RL", "LN")))
df1 %>% 
  ggplot +
  aes(x = variable, y = frac, color = type) +
  geom_hline(yintercept = 1/3) +
  geom_line(alpha = 1/4, aes(group = id)) +
  geom_boxplot(alpha = 1/2, aes(fill = type)) +
  # geom_point(alpha = 1/2, aes(group = id)) +
  scale_x_discrete("") +
  scale_y_continuous("Coaptation area fraction") +
  scale_color_brewer("", palette = "Set1") +
  scale_fill_brewer("", palette = "Set1") +
  facet_wrap(~ type) +
  theme_bw() +
  theme(legend.position = "none",
        panel.grid.major.x = element_blank())
ggsave("../figures/lineplotsLeafletsCoapFrac.png", dpi = 300, height = 4, width = 8, units = "in")
ggsave("../figures/lineplotsLeafletsCoapFrac.svg", dpi = 300, height = 4, width = 8, units = "in")
```

Use a linear model to test if NR and LN fractions are different.

```{r}
M <- 
  df1 %>% 
  lm(frac ~ type + variable + type * variable, data = .)
tidy(M) %>% kable(digits = 3)
p <- tidy(M) %>% filter(grepl("variableLN", term)) %>% select(p.value)
```

* For the cases, NR and LN are `r paste0(isSig(p[1, ]), "ly")` different (p = `r sprintf("%.03f", p[1, ])`)
* For the controls, NR and LN are `r paste0(isSig(p[2, ]), "ly")` different (p = `r sprintf("%.03f", p[2, ])`)

Since NR and LN are not different for both cases and controls,
test if RL fractions are different from NR and LN.

```{r}
M <- 
  df1 %>% 
  mutate(indCasesRL = type == "Case" & variable == "RL",
         indControlRL = type == "Control" & variable == "RL") %>% 
  lm(frac ~ indCasesRL + type + indControlRL, data = .)
tidy(M) %>% kable(digits = 3)
p <- tidy(M) %>% filter(grepl("RLTRUE", term)) %>% select(p.value)
```

* For the cases, RL is `r paste0(isSig(p[1, ]), "ly")` different from NR and LN (p = `r sprintf("%.03f", p[1, ])`)
* For the controls, RL is `r paste0(isSig(p[2, ]), "ly")` different from NR and LN (p = `r sprintf("%.03f", p[2, ])`)
```
